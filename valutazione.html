<!DOCTYPE HTML>
<html>
	<head>
		<title>Alina Stoica</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
		<style>
			.tooltip {
				position: relative;
				display: inline-block;
			}
	
			.tooltip .tooltiptext {
				visibility: hidden;
				width: 200px;
				background-color: #d4d4d4;
				border: 2px solid #000000;
				color: #333;
				font-weight: bold;
				text-align: center;
				border-radius: 6px;
				padding: 5px;
				position: absolute;
				z-index: 1;
				left: 50%;
				margin-left: -100px;
				opacity: 0;
				transition: opacity 0.3s;
			}
	
			.tooltip:hover .tooltiptext {
				visibility: visible;
				opacity: 1;
			}
			
			
			
			#suggestions-box {
			    font-size: 13px;
				font-family: fangsong;
				color: #000;
				position: absolute;
				width: 100%;
				background-color: white;
				border: 1px solid #ccc;
				max-height: 200px;
				overflow-y: auto;
				z-index: 1000; /* Assicura che il box sia sopra gli altri contenuti */
				display: none; /* Inizialmente nascosto */
			}
			
			#suggestions-box .suggestion {
				padding: 8px 12px;
				cursor: pointer;
			}
			
			#suggestions-box .suggestion:hover {
				background-color: #f0f0f0;
			}
		</style>
	</head>
	<body class="is-preload">
		<div id="page-wrapper">

			<!-- Header -->
				<header id="header">
					<!--<h1 id="logo"><a href="index.html">Alina Stoica</a></h1>-->
					<nav id="nav">
						<ul>
							<li><a href="index.html">Home</a></li>
							<!--
							<li>
								<a href="#">Layouts</a>
								<ul>
									<li><a href="left-sidebar.html">Left Sidebar</a></li>
									<li><a href="right-sidebar.html">Right Sidebar</a></li>
									<li><a href="no-sidebar.html">No Sidebar</a></li>
									<li>
										<a href="#">Submenu</a>
										<ul>
											<li><a href="#">Option 1</a></li>
											<li><a href="#">Option 2</a></li>
											<li><a href="#">Option 3</a></li>
											<li><a href="#">Option 4</a></li>
										</ul>
									</li>
								</ul>
							</li>
							-->
							<!--<li><a href="realizzazioni.html">Realizzazioni</a></li>-->
							<li><a href="servizi.html">Servizi</a></li>
							<li><a href="contatti.html">Contatti</a></li>
							<li><a href="valutazione.html" class="button primary">Valutazione Immobiliare</a></li>
						</ul>
					</nav>
				</header>

			<!-- Main -->
				<div id="main" class="wrapper style1" style="padding 3em 0 0 0">
					<div class="container">
						<!-- Form -->
							<section>
								<!--
								<iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2838.1268911194657!2d10.932793775713488!3d44.6557590870156!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x477fef22717c629b%3A0x4065b314904cc24d!2sViale%20A.%20Gramsci%2C%2026%2C%2041122%20Modena%20MO!5e0!3m2!1sit!2sit!4v1719237671720!5m2!1sit!2sit" 
									width="100%" 
									height="450" 
									style="border-radius:10px;" 
									allowfullscreen="" 
									loading="lazy" 
									referrerpolicy="no-referrer-when-downgrade">
								</iframe>
								-->
								<form method="post" action="#">
									<div class="row gtr-uniform gtr-50">
										<div class="col-4 col-12-medium">
											<input type="radio" id="vendita" name="contratto" value="VENDITA" checked>
											<label for="vendita">VENDITA</label>
										</div>
										<div class="col-4 col-12-medium">
											<input type="radio" id="affitto" name="contratto" value="AFFITTO">
											<label for="affitto">AFFITTO</label>
										</div>
										<div class="col-12 col-12-xsmall tooltip">
											<input type="text" name="indirizzo_val" id="indirizzo_val" value=""  oninput="getAddressSuggestions(this.value)" placeholder="Indirizzo" data-tooltip="Inserisci l'indirizzo completo dell'immobile"/>
											<span class="tooltiptext">Inserisci l'indirizzo completo dell'immobile</span>
											<div id="suggestions-box"></div>
											<div id="output" style="display: block"></div>
										</div>
										<div class="col-6 col-12-xsmall tooltip">
											<select name="n_bagni_val" id="n_bagni_val" data-tooltip="Inserisci il numero di bagni nell'appartamento">
												<option value="">N° Bagni</option>
												<option value="1">1</option>
												<option value="2">2</option>
												<option value="3">3+</option>
											</select>
											<span class="tooltiptext">Seleziona il numero di bagni nell'appartamento</span>
										</div>
										<div class="col-6 col-12-xsmall tooltip">
											<input type="text" name="MQ_val" id="MQ_val" value="" placeholder="Metri Quadrati (esempio: 80)"  data-tooltip="Inserisci i metri quadrati dell'appartamento"/>
											<span class="tooltiptext">Inserisci i metri quadrati dell'appartamento</span>
										</div>
										<div class="col-6 col-12-xsmall tooltip">
											<select name="stato_val" id="stato_val" data-tooltip="Seleziona lo stato dell'immobile">
												<option value="">Stato Immobile</option>
												<option value="1">Da Ristrutturare</option>
												<option value="2">Scarso/Abitabile</option>
												<option value="3">Discreto/Abitabile</option>
												<option value="4">Buono/Abitabile</option>
												<option value="5">Nuovo/Ristrutturato</option>
											</select>
											<span class="tooltiptext">Seleziona lo stato dell'immobile</span>
										</div>
										<div class="col-6 col-12-xsmall tooltip">
											<input type="text" name="Eta_Edificio_val" id="Eta_Edificio_val" value="" placeholder="Anni dell'Edificio (esempio: 20)" data-tooltip="Inserisci l'età dell'edificio" />
											<span class="tooltiptext">Inserisci l'età dell'edificio</span>
										</div>
										<div class="col-6 col-12-xsmall tooltip">
											<select name="ascensore_val" id="ascensore_val" data-tooltip="Indicare la presenza dell'ascensore">
												<option value="">Ascensore</option>
												<option value="1">Si</option>
												<option value="2">No</option>
											</select>
											<span class="tooltiptext">Indicare la presenza dell'ascensore</span>
										</div>
										<div class="col-6 col-12-xsmall tooltip">
											<input type="text" name="giardino_val" id="giardino_val" value="" placeholder="Metri Quadri del Giardino (0 se asssente)" data-tooltip="Inserire metri quadrati del giardino"/>
											<span class="tooltiptext">Inserire metri quadrati del giardino</span>
										</div>
										<div class="col-6 col-12-xsmall tooltip">
											<select name="piano_val" id="piano_val" data-tooltip="Selezionare il piano dell'immobile">
												<option value="">Piano dell'Immobile</option>
												<option value="1">Seminterrato</option>
												<option value="2">Piano Terra</option>
												<option value="3">Primo Piano</option>
												<option value="4">Secondo Piano</option>
												<option value="5">Terzo Piano</option>
												<option value="6">Piano Superiore</option>
												<option value="7">Ultimo Piano</option>
												<option value="8">Attico</option>
											</select>
											<span class="tooltiptext">Selezionare il piano dell'immobile</span>
										</div>
										<div class="col-6 col-12-xsmall tooltip">
											<input type="text" name="cantina_val" id="cantina_val" value="" placeholder="Metri Quadri della Cantina/Soffitta (0 se asssente)" data-tooltip="Inserire metri quadrati della cantina + soffitta"/>
											<span class="tooltiptext">Inserire metri quadrati della cantina + soffitta</span>
										</div>
										<div class="col-6 col-12-xsmall tooltip">
											<select name="luce_val" id="luce_val" data-tooltip="Selezionare la luminosità dell'immobile">
												<option value="">Luminosità</option>
												<option value="1">Poco Luminoso</option>
												<option value="2">Mediamente Luminoso</option>
												<option value="3">Luminoso</option>
												<option value="4">Molto Luminoso</option>
											</select>
											<span class="tooltiptext">Selezionare la luminosità dell'immobile</span>
										</div>
										<div class="col-6 col-12-xsmall tooltip">
											<input type="text" name="garage_val" id="garage_val" value="" placeholder="Metri Quadri del Garage (0 se asssente)" data-tooltip="Inserire metri quadrati garage + balconi" />
											<span class="tooltiptext">Inserire metri quadrati garage + balconi</span>
										</div>
										<div class="col-6 col-12-xsmall tooltip">
											<select name="termo_val" id="termo_val" data-tooltip="Selezionare la tipologia di riscaldamento">
												<option value="">Riscaldamento</option>
												<option value="1">Assente</option>
												<option value="2">Centralizzato</option>
												<option value="3">Centralizzato Contabilizzatore</option>
												<option value="4">Autonomo</option>
											</select>
											<span class="tooltiptext">Selezionare la tipologia di riscaldamento</span>
										</div>
										<div class="col-12">
											<ul class="actions">
												<li><input id="btn_process" type="button" value="Calcola Valore Immobiliare" class="primary" onclick="processa()"/></li>
												<li><input type="text" id="risultato" class="primary" readonly></li>
											</ul>
										</div>

										<script>
											//LISTENER PER PASSARE DA AFFITTO A VENDITA E VICEVERSA
											document.addEventListener('DOMContentLoaded', function () {
												document.getElementById('btn_process').addEventListener('click', processa);
												// Aggiungi event listener per i radio buttons
												document.querySelectorAll('input[name="contratto"]').forEach(function (elem) {
													elem.addEventListener('change', processa);
												});
											});
											
											var typingTimer;
											var doneTypingInterval = 500;  // Ritardo in millisecondi, ad esempio 500ms
											
											
											// Aggiungi un event listener per chiudere il box dei suggerimenti se si fa clic fuori di esso
											document.addEventListener('click', function(event) {
												var suggestionsBox = document.getElementById('suggestions-box');
												var targetElement = event.target; // Elemento su cui è stato fatto clic
											
												if (targetElement !== suggestionsBox && !suggestionsBox.contains(targetElement)) {
													suggestionsBox.style.display = 'none';
												}
											});
											
											// Aggiungi l'event listener per touchstart con opzione passive: true
											document.addEventListener('DOMContentLoaded', function() {
												var suggestionsBox = document.getElementById('suggestions-box');
												suggestionsBox.addEventListener('touchstart', function(event) {
													// Codice da eseguire quando si verifica l'evento touchstart
												}, { passive: true });
											});
											
											//BLOCCO SUGGERIMENTO INDIRIZZO
											function getAddressSuggestions(query) {
												clearTimeout(typingTimer);
												typingTimer = setTimeout(function() {
													fetch(`https://nominatim.openstreetmap.org/search?q=${query}&format=json&addressdetails=1`)
														.then(response => response.json())
														.then(data => {
															showSuggestions(data);
														})
														.catch(error => {
															console.error('Si è verificato un errore durante il recupero dei suggerimenti di indirizzo:', error);
														});
												}, doneTypingInterval);
											}
											
											function showSuggestions(suggestions) {
												var suggestionsBox = document.getElementById('suggestions-box');
												suggestionsBox.innerHTML = ''; // Pulisce il contenuto precedente
												
												if (suggestions && suggestions.length > 0) {
													suggestions.forEach(function(item) {
														var suggestionDiv = document.createElement('div');
														suggestionDiv.classList.add('suggestion');
														suggestionDiv.textContent = item.display_name;
														suggestionDiv.addEventListener('click', function() {
															selectAddress(item);
														});
														suggestionsBox.appendChild(suggestionDiv);
													});
													suggestionsBox.style.display = 'block';
												} else {
													suggestionsBox.style.display = 'none';
												}
											}
											
											function selectAddress(address) {
												document.getElementById('indirizzo_val').value = address.display_name;
												document.getElementById('suggestions-box').style.display = 'none';
											}
											
											//PRESA DELLE COORDINATE DA INDIRIZZO
											async function getCoordinates() {
												const address = document.getElementById('indirizzo_val').value;
												const url = `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(address)}`;
									
												try {
													const response = await fetch(url);
													if (!response.ok) {
														throw new Error('Network response was not ok ' + response.statusText);
													}
													const data = await response.json();
											
													if (data && data.length > 0) {
														const location = data[0];
														address_lat = location.lat;
														address_lng = location.lon;
														document.getElementById('output').innerText = `Latitudine: ${address_lat}, Longitudine: ${address_lng}`;
														inputlat.value = address_lat;
														inputlng.value = address_lng;
													} else {
														document.getElementById('output').innerText = 'Nessuna coordinata trovata per questo indirizzo.';
													}
												} catch (error) {
													document.getElementById('output').innerText = `Errore nella richiesta: ${error.message}`;
												}
											}
											
											//MAIN FUNZIONE
											async function processa() {
											
												getCoordinates();
												
												// Ottieni i valori degli input
												var indirizzo = document.getElementById('indirizzo_val').value;
												var MQ = document.getElementById('MQ_val').value;
												var stato = document.getElementById('stato_val').value;
												var piano = document.getElementById('piano_val').value;
												var ascensore = document.getElementById('ascensore_val').value;
												var edificio = document.getElementById('Eta_Edificio_val').value;
												var luce = document.getElementById('luce_val').value;
												var riscaldamento = document.getElementById('termo_val').value;
												var giardino = document.getElementById('giardino_val').value;
												var garage = document.getElementById('garage_val').value;
												var cantina = document.getElementById('cantina_val').value;
												var bagni = document.getElementById('n_bagni_val').value;
												var contratto = document.querySelector('input[name="contratto"]:checked').value;
												var address_lat = 0;
												var address_lng = 0;
												var oltregiardino = 0;
												
												const address = document.getElementById('indirizzo_val').value;
												const url = `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(address)}`;
									
												try {
													const response = await fetch(url);
													if (!response.ok) {
														throw new Error('Network response was not ok ' + response.statusText);
													}
													const data = await response.json();
											
													if (data && data.length > 0) {
														const location = data[0];
														address_lat = location.lat;
														address_lng = location.lon;
														document.getElementById('output').innerText = `Latitudine: ${address_lat}, Longitudine: ${address_lng}`;
													} else {
														document.getElementById('output').innerText = 'Nessuna coordinata trovata per questo indirizzo.';
													}
												} catch (error) {
													document.getElementById('output').innerText = `Errore nella richiesta: ${error.message}`;
												}
												
												
												//imposto il costo a MQ
												var prezzoMQ = 1800;
												
												if (contratto == "AFFITTO") {
													prezzoMQ = 7
												}
												
												
												
												//calcolo delle variazioni MQ per variabili
												if (giardino <= 25) {
													giardino = giardino * 0.15;
												} else if (giardino > 25) {
													oltregiardino = giardino - 25;
													giardino = 25;
													giardino = giardino * 0.15;
													oltregiardino = oltregiardino * 0.05;
												}
												
												garage = garage * 0.45;
												cantina = cantina * 0.20;
											
												if (bagni == 1) {
													bagni = 0;
												} else if (bagni == 2) {
													bagni = 0.08;
												} else if (bagni == 3) {
													bagni = 0.15;
												} else {
													bagni = 0;
												}
											
												if (piano == 1) {
													piano = -0.15;
												} else if (piano == 2) {
													piano = 0.10;
												} else if (piano == 3) {
													piano = 0.05;
												} else if (piano == 4) {
													piano = 0.0;
												} else if (piano == 5) {
													piano = 0.05;
												} else if (piano == 6) {
													piano = 0.07;
												} else if (piano == 7) {
													piano = 0.10;
												} else if (piano == 8) {
													piano = 0.15;
												}
												
												if (ascensore == 1) {
													ascensore = 0
												} else if (ascensore == 2) {
													ascensore = -0.15
												}
									
												if (stato == 1) {
													stato = -0.40
												} else if (stato == 2) {
													stato = -0.10
												} else if (stato == 3) {
													stato = -0.0
												} else if (stato == 4) {
													stato = 0.05
												} else if (stato == 5) {
													stato = 0.20
												}
												
												if (luce == 1) {
													luce = -0.15
												} else if (luce == 2) {
													luce = 0
												} else if (luce == 3) {
													luce = 0.08
												} else if (luce == 4) {
													luce = 0.12
												}
												
												if (edificio > 15) {
													edificio = -0.15
												} else {
													edificio = 0
												}
												
												
												if (riscaldamento == 1) {
													riscaldamento = -0.15
												} else if (riscaldamento == 2) {
													riscaldamento = 0
												} else if (riscaldamento == 3) {
													riscaldamento = 0.08
												} else if (riscaldamento == 4) {
													riscaldamento = 0.12
												}
												
												
												result =  ((prezzoMQ * garage) + (prezzoMQ * cantina) + (prezzoMQ * giardino) + (prezzoMQ * oltregiardino)) + (prezzoMQ * MQ) * 
													(piano + 1) * (ascensore + 1) * (stato + 1) * (luce + 1) * (edificio + 1) * (riscaldamento + 1) * (bagni + 1);
															
												// Mostra il risultato
												//document.getElementById('risultato').value = result.toFixed(2);
												//document.getElementById('risultato').value = address_lat;
												
												document.getElementById('risultato').value = result.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,');
												
												
											}
										</script>
									</div>
								</form>
							</section>
					</div>
				</div>

			<!-- Footer -->
				<footer id="footer">
					<ul class="icons" style="margin: 0px 0px 0px 0px;">
						<li><a href="#" class="icon brands alt fa-twitter"><span class="label">Twitter</span></a></li>
						<li><a href="#" class="icon brands alt fa-facebook-f"><span class="label">Facebook</span></a></li>
						<li><a href="#" class="icon brands alt fa-linkedin-in"><span class="label">LinkedIn</span></a></li>
						<li><a href="#" class="icon brands alt fa-instagram"><span class="label">Instagram</span></a></li>
						<li><a href="#" class="icon brands alt fa-github"><span class="label">GitHub</span></a></li>
						<li><a href="#" class="icon solid alt fa-envelope"><span class="label">Email</span></a></li>
					</ul>
					<!--
					<ul class="copyright">
						<li>&copy; Untitled. All rights reserved.</li><li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
					</ul>
					-->
				</footer>

		</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/jquery.dropotron.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>